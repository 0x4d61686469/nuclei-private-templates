id: open-redirect-generic

info:
  name: Generic Open Redirect (3xx + JS Redirects)
  author: mahdi
  severity: Low
  description: Detects server-side 3xx redirects and client-side JS-based redirects.

http:
  - method: GET
    path:
      - "{{BaseURL}}"

    matchers-condition: or
    matchers:
      # 3xx redirect detection
      - type: status
        status:
          - 300
          - 301
          - 302
          - 303
          - 307
          - 308

      # JS-based redirects
      - type: regex
        part: body
        regex:
          - window\.location\s*=\s*["'`](https?:\/\/[^"'`<\s]+)
          - window\.location\.href\s*=\s*["'`](https?:\/\/[^"'`<\s]+)
          - window\.location\.replace\s*\(\s*["'`](https?:\/\/[^"'`<\s]+)
          - window\.location\.assign\s*\(\s*["'`](https?:\/\/[^"'`<\s]+)
          - document\.location\s*=\s*["'`](https?:\/\/[^"'`<\s]+)
          - location\.href\s*=\s*["'`](https?:\/\/[^"'`<\s]+)
          - top\.location\s*=\s*["'`](https?:\/\/[^"'`<\s]+)
          - parent\.location\s*=\s*["'`](https?:\/\/[^"'`<\s]+)
          - eval\s*\(\s*["'`][^"'`]*https?:\/\/[^"'`<\s]+
          - setTimeout\s*\(\s*["'`][^"'`]*https?:\/\/[^"'`<\s]+
          - setInterval\s*\(\s*["'`][^"'`]*https?:\/\/[^"'`<\s]+
          - <meta[^>]+http-equiv=["'`]refresh["'`][^>]*url=https?:\/\/[^"'`<\s]+
          - window\.open\s*\(\s*["'`](https?:\/\/[^"'`<\s]+)

